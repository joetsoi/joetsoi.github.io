<!DOCTYPE html>
<html lang="en-gb">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="theme-color" content="#98AFC7">
	<meta name="msapplication-TileColor" content="#98AFC7">
<meta itemprop="name" content="Randomising Traitor Numbers in Trouble in Terrorist Town">
<meta itemprop="description" content="A while back a group of friends and I went through a spate of playing TTT(Trouble in Terrorist Town), to the point where we ended up playing during that Christmas day post dinner lull.
For me, TTT scratches the traitor game mechanic that you can find in board games like The Resistance, Battlestar Galactica and Shadows Over Camelot which you don&#39;t really get in any other computer game. Unlike these games, the number of traitors is rigidly defined by the total number of players by a formula.">
<meta itemprop="datePublished" content="2015-07-10T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2015-07-10T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="563">



<meta itemprop="keywords" content="game mechanics,lua,trouble in terrorit town," /><meta property="og:title" content="Randomising Traitor Numbers in Trouble in Terrorist Town" />
<meta property="og:description" content="A while back a group of friends and I went through a spate of playing TTT(Trouble in Terrorist Town), to the point where we ended up playing during that Christmas day post dinner lull.
For me, TTT scratches the traitor game mechanic that you can find in board games like The Resistance, Battlestar Galactica and Shadows Over Camelot which you don&#39;t really get in any other computer game. Unlike these games, the number of traitors is rigidly defined by the total number of players by a formula." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://the.chuntering.dev/posts/random-traitor-numbers-in-trouble-in-terrorist-town/" />
<meta property="article:published_time" content="2015-07-10T00:00:00+00:00" />
<meta property="article:modified_time" content="2015-07-10T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Randomising Traitor Numbers in Trouble in Terrorist Town"/>
<meta name="twitter:description" content="A while back a group of friends and I went through a spate of playing TTT(Trouble in Terrorist Town), to the point where we ended up playing during that Christmas day post dinner lull.
For me, TTT scratches the traitor game mechanic that you can find in board games like The Resistance, Battlestar Galactica and Shadows Over Camelot which you don&#39;t really get in any other computer game. Unlike these games, the number of traitors is rigidly defined by the total number of players by a formula."/>

	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/favicon.ico">

	<title>Randomising Traitor Numbers in Trouble in Terrorist Town</title>
	<link rel="stylesheet" href="https://the.chuntering.dev/css/style.min.657bcb7af31123e4156b1a3d2ff60a636717e54ead74f882136b5114cf72b55e.css" integrity="sha256-ZXvLevMRI+QVaxo9L/YKY2cX5U6tdPiCE2tRFM9ytV4=" crossorigin="anonymous">
	
	<link rel="stylesheet" href="https://the.chuntering.dev/css/code.css">
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp faster">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://the.chuntering.dev">Joe T</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					
				<a href="https://the.chuntering.dev/posts/">Posts</a>

				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<span class="hdr-social hide-in-mobile"><a href="https://twitter.com/mythral_mystic" target="_blank" rel="noopener me" title="Twitter"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a><a href="https://github.com/joetsoi" target="_blank" rel="noopener me" title="Github"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></span><button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://the.chuntering.dev/posts/">Posts</a></li>
		</ul>
	</div>


	<main class="site-main section-inner animated fadeIn faster">
		<article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>Jul 10, 2015</span></div>
				<h1>Randomising Traitor Numbers in Trouble in Terrorist Town</h1>
			</header>
			<div class="content">
				<p>A while back a group of friends and I went through a spate of playing TTT(Trouble in Terrorist Town), to the point where we ended up playing during that Christmas day post dinner lull.</p>
<p>For me, TTT scratches the traitor game mechanic that you can find in board games like The Resistance, Battlestar Galactica and Shadows Over Camelot which you don't really get in any other computer game. Unlike these games, the number of traitors is rigidly defined by the total number of players by a formula.</p>
<div class="highlight"><pre class="chroma"><code class="language-lua" data-lang="lua"><span class="kd">local</span> <span class="kr">function</span> <span class="nf">GetTraitorCount</span><span class="p">(</span><span class="n">ply_count</span><span class="p">)</span>
   <span class="c1">-- get number of traitors: pct of players rounded down</span>
   <span class="kd">local</span> <span class="n">traitor_count</span> <span class="o">=</span> <span class="n">math.floor</span><span class="p">(</span><span class="n">ply_count</span> <span class="o">*</span> <span class="n">GetConVar</span><span class="p">(</span><span class="s2">&#34;</span><span class="s2">ttt_traitor_pct</span><span class="s2">&#34;</span><span class="p">)</span><span class="p">:</span><span class="n">GetFloat</span><span class="p">(</span><span class="p">)</span><span class="p">)</span>
   <span class="c1">-- make sure there is at least 1 traitor</span>
   <span class="n">traitor_count</span> <span class="o">=</span> <span class="n">math.Clamp</span><span class="p">(</span><span class="n">traitor_count</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">GetConVar</span><span class="p">(</span><span class="s2">&#34;</span><span class="s2">ttt_traitor_max</span><span class="s2">&#34;</span><span class="p">)</span><span class="p">:</span><span class="n">GetInt</span><span class="p">(</span><span class="p">)</span><span class="p">)</span>

   <span class="kr">return</span> <span class="n">traitor_count</span>
<span class="kr">end</span>
</code></pre></div><p>This means that for a given number of players, the number of traitors/innocents is the same each round. This is probably ok for the public servers, but if you're playing within a small set of friends, knowing that there is two traitors every round gets stale quite quickly. So I ended up quickly writing some (bad) code that adds a second variable <code>ttt_traitor_pct_max</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-lua" data-lang="lua"><span class="n">CreateConVar</span><span class="p">(</span><span class="s2">&#34;</span><span class="s2">ttt_traitor_pct_max</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="s2">0.5</span><span class="s2">&#34;</span><span class="p">)</span>

<span class="kd">local</span> <span class="kr">function</span> <span class="nf">GetTraitorCount</span><span class="p">(</span><span class="n">ply_count</span><span class="p">)</span>
    <span class="c1">-- get the difference between ttt_traitor_pct and traitor_pct_max as a positive real number</span>
    <span class="kd">local</span> <span class="n">traitor_pct_range</span> <span class="o">=</span> <span class="n">math.abs</span><span class="p">(</span><span class="p">(</span><span class="n">GetConVar</span><span class="p">(</span><span class="s2">&#34;</span><span class="s2">ttt_traitor_pct_max</span><span class="s2">&#34;</span><span class="p">)</span><span class="p">:</span><span class="n">GetFloat</span><span class="p">(</span><span class="p">)</span> <span class="o">-</span> <span class="n">GetConVar</span><span class="p">(</span><span class="s1">&#39;</span><span class="s1">ttt_traitor_pct</span><span class="s1">&#39;</span><span class="p">)</span><span class="p">:</span><span class="n">GetFloat</span><span class="p">(</span><span class="p">)</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
    <span class="c1">-- choose a random value in the traitor percentage range</span>
    <span class="kd">local</span> <span class="n">traitor_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">math.random</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">traitor_pct_range</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="c1">-- get number of traitors: pct of players rounded down (with our additional random traitors)</span>
    <span class="kd">local</span> <span class="n">traitor_count</span> <span class="o">=</span> <span class="n">math.floor</span><span class="p">(</span><span class="n">ply_count</span> <span class="o">*</span> <span class="p">(</span><span class="n">GetConVar</span><span class="p">(</span><span class="s2">&#34;</span><span class="s2">ttt_traitor_pct</span><span class="s2">&#34;</span><span class="p">)</span><span class="p">:</span><span class="n">GetFloat</span><span class="p">(</span><span class="p">)</span> <span class="o">+</span> <span class="n">traitor_random</span><span class="p">)</span><span class="p">)</span>
    <span class="c1">-- make sure there is at least 1 traitor</span>
    <span class="n">traitor_count</span> <span class="o">=</span> <span class="n">math.Clamp</span><span class="p">(</span><span class="n">traitor_count</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">GetConVar</span><span class="p">(</span><span class="s2">&#34;</span><span class="s2">ttt_traitor_max</span><span class="s2">&#34;</span><span class="p">)</span><span class="p">:</span><span class="n">GetInt</span><span class="p">(</span><span class="p">)</span><span class="p">)</span>
    <span class="kr">return</span> <span class="n">traitor_count</span>
<span class="kr">end</span>
</code></pre></div><p>The number of traitors is then a random percentage between 20 percent and 50 percent of the number of players. This leaves you guessing about the number of traitors every round. If you set it high enough you can have rounds where there is only one innocent and if all the traitors play along, you can end up stringing along the one innocent for as long as possible.</p>
<p>This could probably be improved by having the percentage of traitors function to be heavily right skew instead of being totally random between the two percentages as in above code snippet, thus making a large number of traitors less likely so you end up with generally one less or one more traitor every round with only the occasional large percentage of traitors. This is the main reason I haven't opened a pull request with this change to the garry's mod repo</p>
<p>I do think this will probably only work amongst a group of friends that you know. If you are doing that however, you'll probably want to turn on the <a href="http://ttt.badking.net/config-and-commands/convars#TOC-Karma">karma system</a>and turn off auto kicking and banning (they're you're friends after all). With no kicking/banning you'll need to give people an incentive to not kill people at random. Generally I do this by turning on the strict karma system(<code>ttt_karma_strict</code>) and upping the amount of karma damage each kill does(<code>ttt_karma_kill_penalty</code>). This means that people who regularly team kill end up doing very little damage until their karma recovers and end up dying in a straight up shoot out, even if they shoot first.</p>
<p>I keep the (vaguely up to date) version of init.lua with these changes at here <a href="https://gist.github.com/joetsoi/7266280">https://gist.github.com/joetsoi/7266280</a>
edit: I've now have a fork which I've applied these changes to <a href="https://github.com/joetsoi/garrysmod">https://github.com/joetsoi/garrysmod</a>.</p>
<p>Happy traitoring!</p>

			</div>
			<hr class="post-end">
			<footer class="post-info">
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://the.chuntering.dev/tags/game-mechanics">game mechanics</a></span><span class="tag"><a href="https://the.chuntering.dev/tags/lua">lua</a></span><span class="tag"><a href="https://the.chuntering.dev/tags/trouble-in-terrorit-town">trouble in terrorit town</a></span>
				</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>563 Words</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2015-07-10 01:00 &#43;0100</p>
			</footer>
		</article>
		<div class="post-nav thin">
			<a class="next-post" href="https://the.chuntering.dev/posts/an-evening-with-assembly/">
				<span class="post-nav-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>&nbsp;Newer</span><br><span>An Evening With Assembly</span>
			</a>
			<a class="prev-post" href="https://the.chuntering.dev/posts/debugging-python-ckan-memory-issues/">
				<span class="post-nav-label">Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>Digging into python memory issues in ckan with heapy</span>
			</a>
		</div>
		<div id="comments" class="thin">
</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2020 <a href="https://the.chuntering.dev">Joe</a> &#183; <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></p>
		<p>
			Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> &#183; Theme <a href="https://github.com/Track3/hermit" target="_blank" rel="noopener">Hermit</a> &#183; <a href="https://the.chuntering.dev/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
		</p>
	</footer>



	<script src="https://the.chuntering.dev/js/bundle.min.4a9a0ac3d2217822c7865b4161e6c2a71de1d70492264337755427898dd718f6.js" integrity="sha256-SpoKw9IheCLHhltBYebCpx3h1wSSJkM3dVQniY3XGPY=" crossorigin="anonymous"></script>
	<script>
	(function() {
		var script = document.createElement('script');
		window.counter = 'https://chunteringdev.goatcounter.com/count'
		script.async = 1;
		script.src = '//gc.zgo.at/count.js';

		var ins = document.getElementsByTagName('script')[0];
		ins.parentNode.insertBefore(script, ins)
	})();
</script>

</body>

</html>
